---
services:
    httpbin-re:
      build: '.'
      expose:
        - '80'
      restart: unless-stopped

    front:
      image: 'docker.io/library/nginx:1.29.3-alpine'
      depends_on:
        - httpbin-re
      ports:
        - '8080:80'
        - '8443:443'
      volumes:
        - './nginx/conf.d:/etc/nginx/conf.d:ro'
        - './nginx/certs:/etc/nginx/certs:ro'
      healthcheck:
        test: ['CMD', 'wget', '-qO', '-', 'http://localhost:8080/healthz']
        interval: 30s
        timeout: 5s
        retries: 3
        start_period: 10s
      restart: unless-stopped